(window.webpackJsonp=window.webpackJsonp||[]).push([[19,17],{407:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n(172),o=n(173),c=(n(31),function(){function e(t){Object(r.a)(this,e),this.pngToLabel=t}return Object(o.a)(e,[{key:"encode",value:function(object){return console.log({toencode:object}),{flipX:object.flipX,flipY:object.flipY,top:object.top,left:object.left,angle:object.angle,scaleX:object.scaleX,scaleY:object.scaleY,width:object.width,height:object.height,src:this.pngToLabel[object.src]||object.src}}}]),e}()),l=function(){function e(t){Object(r.a)(this,e),this.labelToPng=t}return Object(o.a)(e,[{key:"decode",value:function(object){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=JSON.parse('{"type":"image","version":"5.3.0","originX":"center","originY":"center","left":396.78,"top":191.9,"width":473,"height":528,"fill":"rgb(0,0,0)","stroke":null,"strokeWidth":0,"strokeDashArray":null,"strokeLineCap":"butt","strokeDashOffset":0,"strokeLineJoin":"miter","strokeUniform":false,"strokeMiterLimit":4,"scaleX":0.29,"scaleY":0.29,"angle":345.56,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"backgroundColor":"","fillRule":"nonzero","paintFirst":"fill","globalCompositeOperation":"source-over","skewX":0,"skewY":0,"cropX":0,"cropY":0,"crossOrigin":null,"filters":[]}');return t.flipX=object.flipX,t.flipY=object.flipY,t.top=object.top*e,t.left=object.left*e,t.angle=object.angle,t.scaleX=object.scaleX*e,t.scaleY=object.scaleY*e,t.width=object.width,t.height=object.height,t.src=this.labelToPng[object.src]||object.src,t}}]),e}()},408:function(e,t,n){var content=n(414);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(102).default)("4d2e8540",content,!0,{sourceMap:!1})},411:function(e,t,n){"use strict";n.r(t);var r,o,c,l,d,f,h,v,m,y,w,O=n(12),_=n(104),x=n(2),j=(n(55),n(168),n(31),n(64),n(16),n(27),n(450),n(103),n(46),n(47),n(412),n(244),n(451)),k=n(3),R=n(82),U=n(407);n(170);function A(e){return C.apply(this,arguments)}function C(){return(C=Object(O.a)(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Running"),t&&t.type.startsWith("image/")){e.next=3;break}throw new Error("Please select a valid image file.");case 3:return e.next=5,new Promise((function(e,n){var r=new FileReader;r.onload=function(t){var img=new Image;img.onload=function(){var canvas=document.createElement("canvas");canvas.width=img.width,canvas.height=img.height,canvas.getContext("2d").drawImage(img,0,0);var t=canvas.toDataURL("image/png");e(t)},img.onerror=function(){return n(new Error("Failed to load the image."))},img.src=t.target.result},r.onerror=function(){return n(new Error("Failed to read the file."))},r.readAsDataURL(t)}));case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var B=k.c.div(r||(r=Object(x.a)(["\n  display: flex;\n  flex-direction: column;\n  max-width: 90vw;\n  gap: 8px;\n"]))),E=k.c.div(o||(o=Object(x.a)(["\n  width: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n"]))),L=Object(k.c)("div",{disabled:Boolean})(c||(c=Object(x.a)(["\n  text-align: center;\n  padding: 12px 20px;\n  border: 1px solid;\n  border-color: ",";\n  border-radius: 12px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: ",";\n  opacity: ",";\n"])),(function(e){return e.theme.text1}),(function(e){return e.disabled?"not-allowed":"pointer"}),(function(e){return e.disabled?"0.5":"1"})),S=Object(k.c)(L)(l||(l=Object(x.a)(["\n\n"]))),I=k.c.div(d||(d=Object(x.a)(["\n  overflow: auto;\n  width: 100%;\n"]))),T=Object(k.c)(L)(f||(f=Object(x.a)(["\n  border-color: ",";\n  float: left;\n  min-height: 60px;\n  max-height: 60px;\n  margin-right: 16px;\n  width: calc(25% - 12px);\n  transition: background-color .1s ease-in;\n\n  &:hover {\n    background-color: ",";\n  }\n\n  &:last-child {\n    border-color: ",";\n    width: calc(50% - 12px);\n    margin-right: 0;\n\n    &:hover {\n      background-color: ",";\n    }\n  }\n\n  img {\n    max-width: 30px;\n    height: auto;\n    width: auto;\n  }\n"])),(function(e){return e.theme.text3}),(function(e){var t=e.disabled,n=e.theme;return!t&&Object(R.c)(.9,n.text3)}),(function(e){return e.theme.red1}),(function(e){var t=e.disabled,n=e.theme;return!t&&Object(R.c)(.9,n.red1)})),$=k.c.div(h||(h=Object(x.a)(["\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n"]))),D=k.c.div(v||(v=Object(x.a)(["\n  overflow: auto;\n  width: 100%;\n"]))),W={components:{Wrapper:B,UploaderWrapper:E,Uploader:S,UndoRedoWrapper:I,UndoRedoButton:T,Controls:$,Overlays:D,AddHatButton:Object(k.c)(L,{totalCells:Number})(m||(m=Object(x.a)(["\n  border-color: ",";\n  float: left;\n  min-height: 60px;\n  max-height: 60px;\n  margin-right: ","px;\n  width: calc((100% - ","px)/",");\n  transition: background-color .1s ease-in;\n\n  &:hover {\n    background-color: ",";\n  }\n\n  &:last-child {\n    margin-right: 0;\n  }\n\n  img {\n    max-width: 30px;\n    height: auto;\n    width: auto;\n  }\n"])),(function(e){return e.theme.blue1}),14,(function(e){return 14*(e.totalCells-1)}),(function(e){return e.totalCells}),(function(e){var t=e.disabled,n=e.theme;return!t&&Object(R.c)(.85,n.blue1)})),DownloadButton:Object(k.c)(L)(y||(y=Object(x.a)(["\n  border-color: ",";\n"])),(function(e){return e.theme.yellow1})),EditCanvas:Object(k.c)("canvas",{disabled:Boolean})(w||(w=Object(x.a)(["\n  border: 1px dashed ",";\n  opacity: ",";\n  max-width: 90vw;\n  width: 100%;\n  height: 300px;\n"])),(function(e){return e.theme.text1}),(function(e){return e.disabled?"0.7":"1"}))},props:{customOverlayEnabled:{type:Boolean,default:!1},newObjectPosition:{type:Object,default:{left:50,top:50,size:50,rotate:0}},historyIndex:{type:Number,default:null},historyLength:{type:Number,default:null},nonAddControlsAbove:{type:Boolean,default:!1},canvasId:{type:String,default:"canvas"},dataURI:{type:String,default:null},current:{type:String,default:null},labelToUri:{type:Object,default:{}},uriToLabel:{type:Object,default:{}}},data:function(){return{objectEncoder:null,objectDecoder:null,lastSelected:null,currentlySelected:null,ready:!1,__canvas:null,latestManualUpdate:null}},computed:{undoDisabled:function(){return!this.ready||(!("number"==typeof this.historyIndex&&"number"==typeof this.historyLength&&this.historyIndex>=0)||this.historyIndex<=0)},redoDisabled:function(){return!this.ready||(!("number"==typeof this.historyIndex&&"number"==typeof this.historyLength&&this.historyIndex>=0)||this.historyIndex===this.historyLength-1)},removeAllOverlaysDisabled:function(){return!this.ready||0===this.totalObjects},totalObjects:function(){if(this.current)return JSON.parse(this.current).length},undoText:function(){return"Undo"+(this.$isMobile()?"":" (U)")},redoText:function(){return"Redo"+(this.$isMobile()?"":" (R)")},removeAllOverlaysText:function(){return"Remove All Overlays"+(this.$isMobile()?"":" (X)")}},watch:{dataURI:function(){this.init()},current:function(){console.log("current() watcher called"),this.ready&&this.current!==this.getCurrentCanvasDataStr()?this.applyCurrentObjects("current changed"):console.log("skipping update, not ready or same canvas string")}},methods:{handleRadiusSet:function(e){var t=this.currentlySelected[0];console.log(this.currentlySelected),console.log(e);var n,r;t.set("clipPath",(n=t,r=200,new j.fabric.Rect({width:n.width,height:n.height,rx:r/n.scaleX,ry:r/n.scaleY,left:-n.width/2,top:-n.height/2}))),this.__canvas.renderAll()},applyCurrentObjects:function(e){var t,n=this;console.log("applyCurrentObjects called",JSON.parse(this.current).length,"from",e),(t=this.__canvas).remove.apply(t,Object(_.a)(this.__canvas.getObjects())),this.__canvas.renderAll();var r=JSON.parse(this.current).map((function(e){return n.objectDecoder.decode(e)}));console.log("Enlivening"+r.length),j.fabric.util.enlivenObjects(r,(function(e){var t=canvas.renderOnAddRemove;n.__canvas.renderOnAddRemove=!1,e.forEach((function(e){n.__canvas.add(e)})),n.__canvas.renderOnAddRemove=t,n.__canvas.renderAll(),console.log(n.__canvas.getObjects().length)}))},deselectAll:function(){var e,t;null===(e=this.__canvas)||void 0===e||e.discardActiveObject(),null===(t=this.__canvas)||void 0===t||t.requestRenderAll()},cloneSelected:function(){var e=this;this.__canvas.getActiveObject().clone((function(t){t.set({left:e.__canvas.getActiveObject().left+10,top:e.__canvas.getActiveObject().top+10,evented:!0}),e.__canvas.discardActiveObject(),"activeSelection"===t.type?(t.canvas=e.__canvas,t.forEachObject((function(t){e.__canvas.add(t)})),t.setCoords()):e.__canvas.add(t),e.__canvas.setActiveObject(t),e.__canvas.requestRenderAll()}))},getPngUri:function(){return this.$refs[this.canvasId].$el.toDataURL("image/png")},getCurrentCanvasDataStr:function(){var e=this,t=this.__canvas.getObjects().map((function(e){return e.toJSON()})).map((function(t){return e.objectEncoder.encode(t)}));return JSON.stringify(t)},handleUpdate:function(e){var t=this.getCurrentCanvasDataStr();console.log("Sending ".concat(JSON.parse(t).length," objects from ").concat(e)),this.latestManualUpdate=t,this.$emit("updated",t)},undo:function(){this.ready&&this.$emit("undo")},redo:function(){this.ready&&this.$emit("redo")},removeAllOverlays:function(){var e;this.removeAllOverlaysDisabled||((e=this.__canvas).remove.apply(e,Object(_.a)(this.__canvas.getObjects())),this.__canvas.renderAll(),this.handleUpdate("removeAllOverlays"))},removeSelectedOverlays:function(){var e;(e=this.__canvas).remove.apply(e,Object(_.a)(this.currentlySelected)),this.__canvas.renderAll(),this.handleUpdate("removeSelectedOverlays")},download:function(){this.ready&&(this.__canvas&&(this.__canvas.selection=!1),this.__canvas.renderAll(),this.$refs.canvas.$el.toBlob((function(e){var t=URL.createObjectURL(e),link=document.createElement("a");link.download="hatted.png",link.href=t,document.body.appendChild(link),link.click(),URL.revokeObjectURL(t),link.remove()}),"image/png"))},init:function(){var e=this;if(this.ready=!1,this.dataURI){this.__canvas&&(this.__canvas.clear(),this.__canvas.dispose());var t=this,canvas=this.__canvas=new j.fabric.Canvas(this.canvasId,{selection:!0,width:t.$refs.canvas.$el.offsetWidth});this.__canvas.selection=!1,this.__canvas.on("object:modified",(function(){e.handleUpdate("object:modified")})),this.__canvas.on("mouse:dblclick",(function(){return e.cloneSelected()})),this.__canvas.on("selection:created",(function(n){e.currentlySelected=n.selected,n.selected.forEach((function(e){return e.bringToFront()})),t.handleUpdate("selection:created")})),this.__canvas.on("selection:updated",(function(n){e.currentlySelected=n.selected,n.selected.forEach((function(e){return e.bringToFront()})),t.handleUpdate("selection:updated")})),this.__canvas.on("selection:cleared",(function(t){e.currentlySelected=null})),j.fabric.Image.fromURL(this.dataURI,(function(img){var e=img.height/img.width,n=canvas.width,r=Math.floor(parseInt(t.$refs.canvas.$el.style.width)*e);canvas.setHeight(r),t.$emit("latestWidth",n),canvas.setBackgroundImage(img,canvas.renderAll.bind(canvas),{scaleX:canvas.width/img.width,scaleY:canvas.height/img.height}),t.reloadHatMaf()}))}},reloadHatMaf:function(){var e=this,canvas=this.__canvas,img=document.createElement("img");img.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3C!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3E%3Csvg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='595.275px' height='595.275px' viewBox='200 215 230 470' xml:space='preserve'%3E%3Ccircle style='fill:%23F44336;' cx='299.76' cy='439.067' r='218.516'/%3E%3Cg%3E%3Crect x='267.162' y='307.978' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -222.6202 340.6915)' style='fill:white;' width='65.545' height='262.18'/%3E%3Crect x='266.988' y='308.153' transform='matrix(0.7071 0.7071 -0.7071 0.7071 398.3889 -83.3116)' style='fill:white;' width='65.544' height='262.179'/%3E%3C/g%3E%3C/svg%3E",j.fabric.Object.prototype.transparentCorners=!1,j.fabric.Object.prototype.cornerColor="blue",j.fabric.Object.prototype.cornerStyle="circle";var t=e.newObjectPosition.size/100,n=function(img){var n=canvas.width*t,r=canvas.height*t,o=n/img.width,c=r/img.height,l=Math.min(o,c);img.scale(l),img.set({left:canvas.width*(e.newObjectPosition.left/100),top:canvas.height*(e.newObjectPosition.top/100),originX:"center",originY:"center",angle:0}),img.rotate(e.newObjectPosition.rotate),canvas.add(img).renderAll().setActiveObject(img).renderAll()},r=function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ready){t.next=2;break}return t.abrupt("return");case 2:new j.fabric.Image.fromURL(e.labelToUri.hat,n);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),o=function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ready){t.next=2;break}return t.abrupt("return");case 2:new j.fabric.Image.fromURL(e.labelToUri.dog,n);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),c=function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ready){t.next=2;break}return t.abrupt("return");case 2:new j.fabric.Image.fromURL(e.labelToUri.shark,n);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),l=function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ready){t.next=2;break}return t.abrupt("return");case 2:new j.fabric.Image.fromURL(e.labelToUri.cat,n);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),d=function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ready){t.next=2;break}return t.abrupt("return");case 2:new j.fabric.Image.fromURL(e.labelToUri.redacted,n);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),f=function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ready){t.next=2;break}return t.abrupt("return");case 2:new j.fabric.Image.fromURL(e.labelToUri.cartoon,n);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),h=function(){var t=Object(O.a)(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.ready){t.next=2;break}return t.abrupt("return");case 2:new j.fabric.Image.fromURL(r,n);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();j.fabric.Object.prototype.controls.deleteControl=new j.fabric.Control({x:.5,y:-.5,offsetY:16,cursorStyle:"pointer",mouseUpHandler:function(t,n){var r=n.target,canvas=r.canvas;canvas.remove(r),canvas.requestRenderAll(),e.handleUpdate("deleteObject")},render:function(e,t,n,r,o){var c=this.cornerSize;e.save(),e.translate(t,n),e.rotate(j.fabric.util.degreesToRadians(o.angle)),e.drawImage(img,-c/2,-c/2,c,c),e.restore()},cornerSize:24}),e.$refs.addHatBtn.$el.onclick=function(){r()},e.$refs.addDogBtn.$el.onclick=function(){o()},e.$refs.addSharkBtn.$el.onclick=function(){c()},e.$refs.addCatBtn.$el.onclick=function(){l()},e.$refs.addRedactedBtn.$el.onclick=function(){d()},e.$refs.addCartoonBtn.$el.onclick=function(){f()},e.customOverlayEnabled&&(e.$refs.addCustomBtn.$el.onclick=function(){e.$refs.customOverlayInput.click()},e.$refs.customOverlayInput.addEventListener("change",function(){var e=Object(O.a)(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.files[0],e.prev=1,e.next=4,A(n);case 4:r=e.sent,h(r),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),alert(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}())),e.ready=!0,e.applyCurrentObjects("fabric.Image.fromURL")}},mounted:function(){this.objectEncoder=new U.b(this.uriToLabel),this.objectDecoder=new U.a(this.labelToUri),this.init()}},Y=W,X=(n(413),n(20)),component=Object(X.a)(Y,(function(){var e=this,t=e._self._c;return t("Wrapper",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.deselectAll,expression:"deselectAll"}]},[e.nonAddControlsAbove?e._e():t("UndoRedoWrapper",[t("UndoRedoButton",{attrs:{disabled:e.undoDisabled},on:{click:e.undo}},[e._v(e._s(e.undoText))]),e._v(" "),t("UndoRedoButton",{attrs:{disabled:e.redoDisabled},on:{click:e.redo}},[e._v(e._s(e.redoText))]),e._v(" "),t("UndoRedoButton",{attrs:{disabled:e.removeAllOverlaysDisabled},on:{click:e.removeAllOverlays}},[e._v(e._s(e.removeAllOverlaysText))])],1),e._v(" "),t("div",[t("EditCanvas",{ref:"canvas",staticStyle:{"border-radius":"14px"},attrs:{disabled:!e.ready,id:e.canvasId}})],1),e._v(" "),e.nonAddControlsAbove?t("UndoRedoWrapper",[t("UndoRedoButton",{attrs:{disabled:e.undoDisabled},on:{click:e.undo}},[e._v(e._s(e.undoText))]),e._v(" "),t("UndoRedoButton",{attrs:{disabled:e.redoDisabled},on:{click:e.redo}},[e._v(e._s(e.redoText))]),e._v(" "),t("UndoRedoButton",{attrs:{disabled:e.removeAllOverlaysDisabled},on:{click:e.removeAllOverlays}},[e._v(e._s(e.removeAllOverlaysText))])],1):e._e(),e._v(" "),t("Controls",[t("Overlays",[t("AddHatButton",{ref:"addHatBtn",attrs:{totalCells:6,disabled:!e.ready}},[t("img",{attrs:{src:"/overlays/hat.png"}})]),e._v(" "),t("AddHatButton",{ref:"addDogBtn",attrs:{totalCells:6,disabled:!e.ready}},[t("img",{attrs:{src:"/overlays/dog.png"}})]),e._v(" "),t("AddHatButton",{ref:"addSharkBtn",attrs:{totalCells:6,disabled:!e.ready}},[t("img",{attrs:{src:"/overlays/shark.png"}})]),e._v(" "),t("AddHatButton",{ref:"addCatBtn",attrs:{totalCells:6,disabled:!e.ready}},[t("img",{attrs:{src:"/overlays/cat.png"}})]),e._v(" "),t("AddHatButton",{ref:"addRedactedBtn",attrs:{totalCells:6,disabled:!e.ready}},[t("img",{attrs:{src:"/overlays/redacted.png"}})]),e._v(" "),t("AddHatButton",{ref:"addCartoonBtn",attrs:{totalCells:6,disabled:!e.ready}},[t("img",{attrs:{src:"/overlays/cartoon.png"}})])],1)],1),e._v(" "),e.customOverlayEnabled?[t("input",{ref:"customOverlayInput",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"}}),e._v(" "),t("AddHatButton",{ref:"addCustomBtn",attrs:{totalCells:1,disabled:!e.ready}},[e._v("Add custom overlay")])]:e._e()],2)}),[],!1,null,"15c2f0ea",null);t.default=component.exports},413:function(e,t,n){"use strict";n(408)},414:function(e,t,n){var r=n(101)((function(i){return i[1]}));r.push([e.i,".controls[data-v-15c2f0ea]{display:inline-block}",""]),r.locals={},e.exports=r},440:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12);n(55),n(16),n(64),n(31),n(27);function o(e){return new Promise((function(t,n){var img=new Image;img.onload=function(){t({width:img.width,height:img.height})},img.onerror=n,img.src=e}))}var c=function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(t,n,r,c){var l,d,f,canvas,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(t);case 2:return l=e.sent,d=l.width,f=l.height,canvas=new fabric.Canvas(null,{width:d,height:f}),h=d/r,e.next=9,new Promise((function(e,n){fabric.Image.fromURL(t,(function(img){canvas.setBackgroundImage(img,(function(){canvas.renderAll(),e()}),{scaleX:d/img.width,scaleY:f/img.height})}),{crossOrigin:"anonymous"})}));case 9:return e.next=11,new Promise((function(e,t){var r=JSON.parse(n).map((function(e){return c.decode(e,h)}));console.log({ratio:h,objects:r}),fabric.util.enlivenObjects(r,(function(t){t.forEach((function(e){canvas.add(e)})),canvas.renderAll(),e()}))}));case 11:return e.abrupt("return",canvas.lowerCanvasEl.toDataURL());case 12:case"end":return e.stop()}}),e)})));return function(t,n,r,o){return e.apply(this,arguments)}}()},441:function(e,t,n){"use strict";n(415),n(16),n(416),n(417),n(418),n(419),n(420),n(421),n(422),n(423),n(424),n(425),n(426),n(427),n(428),n(429),n(430),n(431),n(432),n(433),n(434),n(435),n(436),n(437),n(438),n(439),n(46),n(47),n(412),n(244);t.a=function(e,t){var n;n=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(var r=e.split(",")[0].split(":")[1].split(";")[0],o=new Uint8Array(n.length),i=0;i<n.length;i++)o[i]=n.charCodeAt(i);var c=new Blob([o],{type:r}),l=URL.createObjectURL(c),link=document.createElement("a");link.download=t,link.href=l,document.body.appendChild(link),link.click(),URL.revokeObjectURL(l),link.remove()}},443:function(e,t,n){var content=n(461);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(102).default)("2662a8c3",content,!0,{sourceMap:!1})},452:function(e,t){},453:function(e,t){},454:function(e,t){},460:function(e,t,n){"use strict";n(443)},461:function(e,t,n){var r=n(101)((function(i){return i[1]}));r.push([e.i,".controls[data-v-19042273]{display:inline-block}",""]),r.locals={},e.exports=r},480:function(e,t,n){"use strict";n.r(t);var r,o,c,l=n(12),d=n(2),f=(n(55),n(3)),h=n(440),v=n(407),m=n(62),y=n(441),w=f.c.div(r||(r=Object(d.a)(["\n  display: flex;\n  flex-direction: column;\n  max-width: 90vw;\n  gap: 8px;\n"]))),O=Object(f.c)("div",{disabled:Boolean})(o||(o=Object(d.a)(["\n  padding: 12px 20px;\n  border: 1px solid;\n  border-color: ",";\n  border-radius: 12px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: ",";\n  opacity: ",";\n"])),(function(e){return e.theme.text1}),(function(e){return e.disabled?"not-allowed":"pointer"}),(function(e){return e.disabled?"0.5":"1"})),_={components:{Wrapper:w,DownloadButton:Object(f.c)(O)(c||(c=Object(d.a)(["\n  border-color: ",";\n"])),(function(e){return e.theme.yellow1}))},props:{dataURI:{type:String,default:null},labelToUri:{type:String,default:null},uriToLabel:{type:String,default:null}},data:function(){return{latestManualUpdate:null,latestWidth:null}},computed:{historyLength:function(){var e;return null===(e=this.$store.state.image.history)||void 0===e?void 0:e.length},historyIndex:function(){return this.$store.state.image.index},current:function(){return this.$store.getters[m.a.GET_CURRENT]}},methods:{setLatestWidth:function(e){this.latestWidth=e},handleUpdate:function(e){this.$store.commit(m.b.UPDATE,e)},undo:function(){this.$store.commit(m.b.UNDO)},redo:function(){this.$store.commit(m.b.REDO)},removeAllOverlays:function(){this.$refs.editor.removeAllOverlays()},removeSelectedOverlays:function(){this.$refs.editor.removeSelectedOverlays()},download:function(){var e=this;return Object(l.a)(regeneratorRuntime.mark((function t(){var n,r,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new v.a(e.labelToUri),r=e.dataURI,o=e.$store.getters[m.a.GET_CURRENT],t.next=5,Object(h.a)(r,o,e.latestWidth,n);case 5:c=t.sent,Object(y.a)(c,"hatted.png");case 7:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;this.handleUpdate("[]"),this.keyboardHandler=function(t){switch((t.ctrlKey||t.metaKey)&&("z"!==t.key||t.shiftKey?("z"===t.key&&t.shiftKey||"Z"===t.key&&t.shiftKey)&&e.redo():e.undo()),t.key){case"Backspace":console.log("Backspace key pressed"),e.removeSelectedOverlays();break;case"u":console.log("U key pressed"),e.undo();break;case"r":console.log("R key pressed"),e.redo();break;case"x":console.log("D key pressed"),e.removeAllOverlays()}},window.addEventListener("keydown",this.keyboardHandler)},beforeDestroy:function(){window.removeEventListener("keydown",this.keyboardHandler)}},x=(n(460),n(20)),component=Object(x.a)(_,(function(){var e=this,t=e._self._c;return t("Wrapper",[t("Editor",{ref:"editor",attrs:{nonAddControlsAbove:!1,dataURI:e.dataURI,current:e.current,labelToUri:e.labelToUri,uriToLabel:e.uriToLabel,historyIndex:e.historyIndex,historyLength:e.historyLength},on:{latestWidth:e.setLatestWidth,updated:e.handleUpdate,undo:e.undo,redo:e.redo}}),e._v(" "),t("DownloadButton",{on:{click:e.download}},[e._v("Download 👇")])],1)}),[],!1,null,"19042273",null);t.default=component.exports;installComponents(component,{Editor:n(411).default})}}]);